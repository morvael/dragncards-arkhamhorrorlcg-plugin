{
    "actionLists": {
        "flipCard": [
            ["COND",
                ["AND",
                    ["EQUAL","$ACTIVE_GROUP.groupType", "story"],
                    ["GREATER_THAN", ["LENGTH", "$ACTIVE_GROUP.stackIds"], 0],
                    ["EQUAL", "$ACTIVE_CARD_ID", ["GET_CARD_ID", "$ACTIVE_GROUP_ID", 0, 0]]
                ],
                ["COND",
                    ["EQUAL", "$ACTIVE_CARD.currentSide", "A"],
                    [
                        ["LOG", "{{$ALIAS_N}} advances {{$ACTIVE_FACE.name}}."],
                        ["SET", "/cardById/$ACTIVE_CARD_ID/currentSide", "B"]
                    ],
                    ["TRUE"],
                    [
                        ["LOG", "{{$ALIAS_N}} advances {{$ACTIVE_FACE.name}}."],
                        ["COND",
                            ["GREATER_THAN", ["LENGTH", "$ACTIVE_GROUP.stackIds"], 1],
                            ["MOVE_CARD", "$ACTIVE_CARD_ID", "$ACTIVE_GROUP_ID", -1]
                        ],
                        ["SET", "/cardById/$ACTIVE_CARD_ID/currentSide", "A"]
                    ]
                ],
                ["EQUAL", "$ACTIVE_FACE.type", "MiniInvestigator"],
                [
                    ["COND",
                        ["EQUAL", "$ACTIVE_CARD.currentSide", "A"],
                        [
                            ["LOG", "{{$ALIAS_N}} exhausts {{$ACTIVE_FACE.name}}."],
                            ["SET", "/cardById/$ACTIVE_CARD_ID/currentSide", "B"],
                            ["SET", "/cardById/$ACTIVE_CARD_ID/exhausted", true]
                        ],
                        ["TRUE"],
                        [
                            ["LOG", "{{$ALIAS_N}} readies {{$ACTIVE_FACE.name}}."],
                            ["SET", "/cardById/$ACTIVE_CARD_ID/currentSide", "A"],
                            ["SET", "/cardById/$ACTIVE_CARD_ID/exhausted", false]
                        ]
                    ]
                ],
                ["TRUE"],
                [
                    ["COND",
                        ["EQUAL", "$ACTIVE_CARD.currentSide", "A"],
                        [
                            ["LOG", "{{$ALIAS_N}} flipped {{$ACTIVE_FACE.name}} facedown."],
                            ["SET", "/cardById/$ACTIVE_CARD_ID/currentSide", "B"]
                        ],
                        ["TRUE"],
                        [
                            ["LOG", "{{$ALIAS_N}} flipped {{$ACTIVE_FACE.name}} faceup."],
                            ["SET", "/cardById/$ACTIVE_CARD_ID/currentSide", "A"]
                        ]
                    ]
                ]
            ]
        ]
    },
    "labels": {
        "flipCard": {
            "English": "Flip"
        }
    }
}