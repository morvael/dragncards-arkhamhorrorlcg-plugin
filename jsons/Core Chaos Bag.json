{
    "actionLists": {
        "addChaosTokens": [
            ["PROMPT", "$PLAYER_N", "addChaosTokens"]
        ],
        "removeChaosTokens": [
            ["PROMPT", "$PLAYER_N", "removeChaosTokens"]
        ],
        "pickChaosToken": [
            ["COND",
                ["GREATER_THAN", ["LENGTH", "$GROUP_BY_ID.sharedChaosBag.stackIds"], 1],
                ["SHUFFLE_GROUP", "sharedChaosBag"]
            ],
            ["COND",
                ["GREATER_THAN", ["LENGTH", "$GROUP_BY_ID.sharedChaosBag.stackIds"], 0],
                [
                    ["VAR", "$CHAOS_TOKEN_ID", ["GET_CARD_ID", "sharedChaosBag", 0, 0]],
                    ["LOG", "{{$ALIAS_N}} reveals {{$CARD_BY_ID.$CHAOS_TOKEN_ID.sides.A.name}} from the Chaos Bag."],
                    ["DO_MOVE_CARD", "$CHAOS_TOKEN_ID", "sharedVoid", 0, false, null],
                    ["DO_FLIP_FACEUP", "$CHAOS_TOKEN_ID", false, null]
                ]
            ]
        ],
        "listChaosTokens": [
            ["VAR", "$MESSAGE", ""],
            ["VAR", "$SEPARATOR", ""],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "+1"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "0"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-1"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-2"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-3"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-4"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-5"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-6"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-7"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "-8"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Elder Thing"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Cultist"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Skull"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Tablet"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Bless"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Curse"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Frost"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Auto Fail"],
            ["DO_APPEND_CHAOS_TOKEN_COUNT", "Elder Sign"],
            ["LOG", "{{$ALIAS_N}} counts Chaos Tokens: {{$MESSAGE}}."]
        ]
    },
    "functions": {
        "DO_APPEND_CHAOS_TOKEN_COUNT": {
            "args": ["$CHAOS_TOKEN_NAME"],
            "code": [
                ["VAR", "$CHAOS_TOKEN_COUNT", ["GET_CHAOS_TOKEN_COUNT", "$CHAOS_TOKEN_NAME"]],
                ["COND", ["GREATER_THAN", "$CHAOS_TOKEN_COUNT", 0], [
                    ["UPDATE_VAR", "$MESSAGE", "{{$MESSAGE}}{{$SEPARATOR}}{{$CHAOS_TOKEN_COUNT}}x {{$CHAOS_TOKEN_NAME}}"],
                    ["UPDATE_VAR", "$SEPARATOR", ", "]
                ]]
            ]
        },
        "DO_ADD_CHAOS_TOKEN": {
            "args": ["$CHAOS_TOKEN_NAME", "$CHAOS_TOKEN_DATABASE_ID", "$MAX_CHAOS_TOKENS", "$LOG_EVENT", "$ACTOR_PLAYER"],
            "code": [
                ["VAR", "$CHAOS_TOKEN_COUNT", ["GET_CHAOS_TOKEN_COUNT", "$CHAOS_TOKEN_NAME"]],
                ["VAR", "$LEFT_TO_ADD", ["SUBTRACT", "$MAX_CHAOS_TOKENS", "$CHAOS_TOKEN_COUNT"]],
                ["COND",
                    ["GREATER_THAN", "$LEFT_TO_ADD", 0],
                    [
                        ["DO_LOG", "$LOG_EVENT", "$ACTOR_PLAYER", "adds {{$CHAOS_TOKEN_NAME}} to the Chaos Bag.", "{{$CHAOS_TOKEN_NAME}} is added to the Chaos Bag."],
                        ["DO_CREATE_CARDS", null, "$CHAOS_TOKEN_DATABASE_ID", 1, "sharedChaosBag", false]
                    ]
                ]
            ]
        },
        "DO_REMOVE_CHAOS_TOKEN": {
            "args": ["$CHAOS_TOKEN_NAME", "$CHAOS_TOKEN_DATABASE_ID", "$LOG_EVENT", "$ACTOR_PLAYER"],
            "code": [
                ["DEFINE", "$DO_REMOVE_CHAOS_TOKEN_RESULT", false],
                ["VAR", "$CHAOS_TOKEN_ID", ["GET_CHAOS_TOKEN_BAG_CARD_ID", "$CHAOS_TOKEN_NAME"]],
                ["COND",
                    ["NOT_EQUAL", "$CHAOS_TOKEN_ID", null],
                    ["DO_DELETE_CARD", "$CHAOS_TOKEN_ID", "$LOG_EVENT", "$ACTOR_PLAYER"],
                    ["DEFINE", "$DO_REMOVE_CHAOS_TOKEN_RESULT", true]
                ]
            ]
        }
    },
    "prompts": {
        "addChaosTokens": {
            "args": [],
            "message": "Pick Chaos Token to add.",
            "options": [
                {
                    "label": "Elder Thing",
                    "hotkey": "E",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Elder Thing", "chaos_elder_thing", 4, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Cultist",
                    "hotkey": "U",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Cultist", "chaos_cultist", 4, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Skull",
                    "hotkey": "S",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Skull", "chaos_skull", 4, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Tablet",
                    "hotkey": "T",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Tablet", "chaos_tablet", 4, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Bless",
                    "hotkey": "B",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Bless", "chaos_bless", 10, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Curse",
                    "hotkey": "C",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Curse", "chaos_curse", 10, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Frost",
                    "hotkey": "F",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "Frost", "chaos_frost", 8, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Numeric",
                    "hotkey": "N",
                    "code": [
                        ["PROMPT", "$PLAYER_N", "addChaosTokensNumeric"]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        },
        "addChaosTokensNumeric": {
            "args": [],
            "message": "Pick Chaos Token to add.",
            "options": [
                {
                    "label": "+1",
                    "hotkey": "I",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "+1", "chaos_p1", 3, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "0",
                    "hotkey": "0",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "0", "chaos_p0", 4, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-1",
                    "hotkey": "1",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-1", "chaos_m1", 5, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-2",
                    "hotkey": "2",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-2", "chaos_m2", 4, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-3",
                    "hotkey": "3",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-3", "chaos_m3", 3, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-4",
                    "hotkey": "4",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-4", "chaos_m4", 2, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-5",
                    "hotkey": "5",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-5", "chaos_m5", 2, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-6",
                    "hotkey": "6",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-6", "chaos_m6", 1, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-7",
                    "hotkey": "7",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-7", "chaos_m7", 1, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-8",
                    "hotkey": "8",
                    "code": [
                        ["DO_ADD_CHAOS_TOKEN", "-8", "chaos_m8", 1, true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        },
        "removeChaosTokens": {
            "args": [],
            "message": "Pick Chaos Token to remove.",
            "options": [
                {
                    "label": "Elder Thing",
                    "hotkey": "E",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Elder Thing", "chaos_elder_thing", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Cultist",
                    "hotkey": "U",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Cultist", "chaos_cultist", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Skull",
                    "hotkey": "S",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Skull", "chaos_skull", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Tablet",
                    "hotkey": "T",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Tablet", "chaos_tablet", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Bless",
                    "hotkey": "B",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Bless", "chaos_bless", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Curse",
                    "hotkey": "C",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Curse", "chaos_curse", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Frost",
                    "hotkey": "F",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "Frost", "chaos_frost", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Numeric",
                    "hotkey": "N",
                    "code": [
                        ["PROMPT", "$PLAYER_N", "removeChaosTokensNumeric"]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        },
        "removeChaosTokensNumeric": {
            "args": [],
            "message": "Pick Chaos Token to remove.",
            "options": [
                {
                    "label": "+1",
                    "hotkey": "I",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "+1", "chaos_p1", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "0",
                    "hotkey": "0",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "0", "chaos_p0", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-1",
                    "hotkey": "1",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-1", "chaos_m1", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-2",
                    "hotkey": "2",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-2", "chaos_m2", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-3",
                    "hotkey": "3",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-3", "chaos_m3", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-4",
                    "hotkey": "4",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-4", "chaos_m4", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-5",
                    "hotkey": "5",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-5", "chaos_m5", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-6",
                    "hotkey": "6",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-6", "chaos_m6", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-7",
                    "hotkey": "7",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-7", "chaos_m7", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "-8",
                    "hotkey": "8",
                    "code": [
                        ["DO_REMOVE_CHAOS_TOKEN", "-8", "chaos_m8", true, "$PLAYER_N"]
                    ]
                },
                {
                    "label": "Cancel",
                    "hotkey": "X"
                }
            ]
        }
    },
    "labels": {
        "addChaosTokens": {
            "English": "Add Chaos Token"
        },
        "removeChaosTokens": {
            "English": "Remove Chaos Token"
        },
        "pickChaosToken": {
            "English": "Reveal Chaos Token"
        },
        "listChaosTokens": {
            "English": "Count Chaos Tokens"
        }
    }    
}